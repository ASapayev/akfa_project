{% extends 'base.html'%}


{% block content %}
<div class="content-wrapper">
    {% if ArtikulComponent %}
    <div class="row ">
    <div class="col-12 grid-margin">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">Артикул  Компонент</h4>
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                    <th>#</th>  
                    <th>Артикул</th>
                    <th>Компонент</th>
                   
                </tr>
              </thead>
              <tbody>
                {%for char in ArtikulComponent  %}
                <tr>
                    <td>
                        {{ forloop.counter }}
                    </td>
                    <td class ='new_char_five' ><input type='text'  id ='artikulfive{{forloop.counter}}' value='{{char}}' required></td>
                    <td ><input type='text'  id ='komponentfive{{forloop.counter}}' required></td>
                </tr>
                {% endfor %}
                
              </tbody>
            </table>
        </div>
        <button type="button" class="btn btn-outline-success btn-lg mt-3" onclick ='artikul_component()' id ='char_four'>Готов</button>
        </div>
      </div>
    </div>
    </div>
    {% endif %}
    {% if CharUtilsOne %}
    <div class="row ">
        <div class="col-12 grid-margin">
        <div class="card">
            <div class="card-body">
            <h4 class="card-title">Character utils one</h4>
            <div class="table-responsive">
                <table class="table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Матрица</th>
                        <th>Артикул</th>
                        <th>Высота</th>
                        <th>Ширина</th>
                        <th>Systems</th>
                        <th>Действие</th>
                    </tr>
                </thead>
                <tbody>
                    {%for char in CharUtilsOne%}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td  class ='new_char_one' ><input type='text' id ='matritsa{{forloop.counter}}' value='{{char}}'></td>
                        <td ><input type='text' name='artikulone' id ='artikulone{{forloop.counter}}' value='{{char}}' ></td>
                        <td><input type='text' name='height' id ='height{{forloop.counter}}' style="width: 50px;" placeholder='height...' ></td>
                        <td><input type='text' name='width' id='width{{forloop.counter}}' style="width: 50px;" placeholder='width...'></td>
                        <td><input type='text'name='systems' id ='systems{{forloop.counter}}' placeholder='Enter systems...'></td>
                        <td>
                            <div class="badge badge-outline-danger">Remove</div>
                        </td>
                    </tr>
                    {% endfor%}
                </tbody>
                </table>
            </div>
            <button type="button" class="btn btn-outline-success btn-lg mt-3" onclick ='create_new_char_one()' id ='char_one'>Готов</button>
            </div>
        </div>
        </div>
    </div>
    {% endif %}
    {% if CharUtilsTwo%}
    <div class="row ">
        <div class="col-12 grid-margin">
        <div class="card">
            <div class="card-body">
            <h4 class="card-title">Character utils two</h4>
            <div class="table-responsive">
                <table class="table">
                <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Артикул</th>
                        <th scope="col">Полый или фасонный</th>
                        <th>Действие</th>
                    </tr>
                </thead>
                <tbody>
                    {%for char in CharUtilsTwo  %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td id='artikul{{ forloop.counter }}' class ='new_char' >{{char}}</td>
                        <td>
                            <select class="form-select form-select-sm"style='width:35%' aria-label="Default select example" id="sel{{ forloop.counter }}">
                                <option selected value='Default' >Default</option>
                                <option value="Полый">Полый</option>
                                <option value="Фасонный">Фасонный</option>    
                            </select>
                        </td>
                        <td>
                            <div class="badge badge-outline-danger">Remove</div>
                        </td>
                    </tr>
                    {% endfor%}
                </tbody>
                </table>
            </div>
            <button type="button" class="btn btn-outline-success btn-lg mt-3" onclick ='create_new_char_two()' id ='char_two'>Готов</button>
            </div>
        </div>
        </div>
    </div>
    {% endif %}
    {% if BazaProfile%}
    <div class="row ">
        <div class="col-12 grid-margin">
        <div class="card">
            <div class="card-body">
            <h4 class="card-title">Baza profiles</h4>
            <div class="table-responsive">
                <table class="table">
                <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Артикул</th>
                        <th scope="col">Компонент</th>
                        <th scope="col">Серия</th>
                        <th scope="col">Старый код</th>
                        <th scope="col">Product description</th>
                        <th scope="col">Действие</th>

                    </tr>
                </thead>
                <tbody>
                    {%for char in BazaProfile  %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td class ='new_char_two' ><input type='text'  id ='artikultwo{{forloop.counter}}' value='{{char}}' required></td>
                        <td ><input type='text'  id ='komponent{{forloop.counter}}' value='{{char}}' required></td>
                        <td ><input type='text'  id ='seria{{forloop.counter}}'  required></td>
                        <td ><input type='text'  id ='stariykod{{forloop.counter}}'  required></td>
                        <td ><input type='text'  id ='prodesc{{forloop.counter}}'  required></td>
                        <td>
                            <div class="badge badge-outline-danger">Remove</div>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
                </table>
            </div>
            <button type="button" class="btn btn-outline-success btn-lg mt-3" onclick ='baza_profiley()' id ='char_three'>Готов</button>
            </div>
        </div>
        </div>
    </div>
    {% endif %}
    <div class="row">
        <div class="col-md-6 grid-margin stretch-card">
            <div class="card">
            <div class="card-body">
                  <a href="" class="btn btn-outline-secondary btn-lg btn-block">Все готов</a>
            </div>
            </div>
        </div>
        <div class="col-md-6 grid-margin stretch-card">
            <div class="card">
            <div class="card-body">
                  <button type="button" onclick='excel_file_load()' class="btn btn-outline-secondary btn-lg btn-block">Скачать эксель файл</button>
            </div>
            </div>
        </div>
    </div>
</div>
<script>



function excel_file_load(){

    document.body.style.cursor='wait';

    $.ajax({
        method: "POST",
        url: "{% url 'excel_does_not_exists_add_simple' %}"
        }).done(function( msg ) {
        document.body.style.cursor='default';
        if (msg.saved ==true){
            Swal.fire({
                position: 'top-end',
                icon: 'success',
                title: 'Successfuly saved!',
                showConfirmButton: false,
                timer: 1500
                })
        
        }else{
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Something went wrong!'
                })

        }
    });
}

function artikul_component(){

    var new_char = document.querySelectorAll('.new_char_five');
    var artikul,komponent;

    var default_exists = false;
    var elements =[];

    for(let i=1; i < new_char.length+1; i++){
        artikul = document.getElementById('artikulfive' + i.toString()).value;
        komponent = document.getElementById('komponentfive' + i.toString()).value;
        
        if (artikul ==''){
          default_exists = true;
          break
          }
        if (komponent ==''){
          default_exists = true;
          break
          }
        
        
        var element ={
              'artikul':artikul,
              'komponent':komponent
          }
        elements.push(element);
          
        }

        if (default_exists){
          Swal.fire({
              title: 'Malumotlar to\'liq emas,qaytadan urining !!! ',
              showDenyButton: true,
            })
          }else{
            var myJsonelements = JSON.stringify(elements);

            $.ajax({
                method: "POST",
                url: "{% url 'artikul_component_aluminiy' %}",
                data: {"data":myJsonelements}
              }).done(function( msg ) {
                if (msg.saved ==true){
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Successfuly saved!',
                        showConfirmButton: false,
                        timer: 1500
                      })
                    var btn = document.getElementById('char_four');
                    btn.setAttribute('disabled','True');
                    }else{
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'Something went wrong!'
                          })

                    }
                });
        }        
}
function baza_profiley(){
    var new_char = document.querySelectorAll('.new_char_two');
    var komponent, artikul,seria,stariykod,prodesc;
    var default_exists = false;
    var elements =[];

    for(let i=1; i < new_char.length+1; i++){
        komponent = document.getElementById('komponent' + i.toString()).value;
        artikul = document.getElementById('artikultwo' + i.toString()).value;
        seria = document.getElementById('seria' + i.toString()).value;
        stariykod = document.getElementById('stariykod' + i.toString()).value;
        prodesc = document.getElementById('prodesc' + i.toString()).value;
        
        
        if (seria ==''){
          default_exists = true;
          break
          }
        
        if (stariykod ==''){
          default_exists = true;
          break
          }
        
        if (prodesc ==''){
          default_exists = true;
          break
          }
        
        var element ={
              'komponent':komponent,
              'artikul':artikul,
              'seria':seria,
              'stariykod':stariykod,
              'prodesc':prodesc,
          }
        elements.push(element);
          
        }

        if (default_exists){
          Swal.fire({
              title: 'Malumotlar to\'liq emas,qaytadan urining !!! ',
              showDenyButton: true,
            })
          }else{
            var myJsonelements = JSON.stringify(elements);

            $.ajax({
                method: "POST",
                url: "{% url 'baza_profile_simple' %}",
                data: {"data":myJsonelements}
              }).done(function( msg ) {
                if (msg.saved ==true){
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Successfuly saved!',
                        showConfirmButton: false,
                        timer: 1500
                      })
                    var btn = document.getElementById('char_three');
                    btn.setAttribute('disabled','True');
                    }else{
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'Something went wrong!'
                          })

                    }
                });
        }        
}

function create_new_char_one(){
    var new_char = document.querySelectorAll('.new_char_one');
    var matritsa, artikul,heigth,width,systems;
    var default_exists = false;
    var elements =[];

    for(let i=1; i < new_char.length+1; i++){
        matritsa = document.getElementById('matritsa' + i.toString()).value;
        artikul = document.getElementById('artikulone' + i.toString()).value;
        heigth = document.getElementById('height' + i.toString()).value;
        width = document.getElementById('width' + i.toString()).value;
        systems = document.getElementById('systems' + i.toString()).value;
        
        
        if (heigth ==''){
          default_exists = true;
          break
          }
        if (width ==''){
          default_exists = true;
          break
          }
        
        
        var element ={
              'matritsa':matritsa,
              'artikul':artikul,
              'heigth':heigth,
              'width':width,
              'systems':systems,
          }
        elements.push(element);
          
        }

        if (default_exists){
          Swal.fire({
              title: 'Malumotlar to\'liq emas,qaytadan urining !!! ',
              showDenyButton: true,
            })
          }else{
            var myJsonelements = JSON.stringify(elements);

            $.ajax({
                method: "POST",
                url: "{% url 'add_char_utils_one_simple' %}",
                data: {"data":myJsonelements}
              }).done(function( msg ) {
                if (msg.saved ==true){
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Successfuly saved!',
                        showConfirmButton: false,
                        timer: 1500
                      })
                    var btn = document.getElementById('char_one');
                    btn.setAttribute('disabled','True');
                    }else{
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'Something went wrong!'
                          })

                    }
                });
        }        
}

function create_new_char_two(){
    var new_char = document.querySelectorAll('.new_char');

    var selection, value,text,artikul;

    var default_exists = false;
    var elements =[];

    for(let i=1; i < new_char.length+1; i++){
        artikul = document.getElementById('artikul' + i.toString());
        selection = document.getElementById('sel' + i.toString());
        value = selection.value
        text = selection.options[selection.selectedIndex].text;
        if (text =='Default'){
            default_exists = true;
            break
        }
        var element ={
            'artikul':artikul.innerText,
            'selection':text
        }
        if (elements.includes(element)){
            continue
        }else{
            elements.push(element);
        }
        
    }
    if (default_exists){
        Swal.fire({
            title: 'Malumotlar to\'liq emas,qaytadan urining !!! ',
            showDenyButton: true,
          })
    }else{
        var myJsonelements = JSON.stringify(elements);

        $.ajax({
            method: "POST",
            url: "{% url 'add_char_utils_two_simple' %}",
            data: {"data":myJsonelements}
          }).done(function( msg ) {
            if (msg.saved ==true){
                Swal.fire({
                    position: 'top-end',
                    icon: 'success',
                    title: 'Successfuly saved!',
                    showConfirmButton: false,
                    timer: 1500
                  })
                var btn = document.getElementById('char_two');
                btn.setAttribute('disabled','True');
                }else{
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'Something went wrong!'
                      })

                }
            });
    }
    
}
</script>
{% endblock %}