{% extends 'base.html'%}


{% block content %}
<div class="main-panel">
    <div class="content-wrapper">
      <div class="page-header">
        <h3 class="page-title"> {{section}} </h3>
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">UI Elements</a></li>
            <li class="breadcrumb-item active" aria-current="page">{% if link %}<a type="button" href="{{link}}" class="btn btn-success btn-fw" >Скачать</a>{%else%}Buttons{% endif %}</li>
          </ol>
        </nav>
      </div>
      <div class="row" id ='fileupload'>
        <div class="col-md-12 grid-margin stretch-card">
          <div class="card">
            <div class="card-body">
              <form>
                <div class="d-flex">
                  <div class="mr-auto p-2"><h4 class="card-title">Нормы</h4></div>
                  <div class="p-2"><input type="search" class="form-control" placeholder="Search sapcode" name="search"></div>
                  <div class="p-2"><button class="btn btn-info " style="height: 35px;"  type="submit">Search</button></div>
                </div>
              </form>
              <div id="excel_data" class="mt-5" style="overflow-x: scroll;  ">
                <table class="table table-striped table-bordered" >
                    <tr><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">покраска</th></tr>
                    <tr><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">пресс - 1 линия</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">закалка-1 печь</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">Покрасочная линия SKM</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">Покрасочная линия SAT</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">Покрасочная линия Горизонтал</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">Покрасочная линия Ручная</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">вакуум-1 печка</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">термо-1 линия</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">Наклейка упаковка-1 линия</th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;"></th><th style="background-color: blanchedalmond;">ламинат-1 линия</th></tr>
                    <tr><th style="background-color: blanchedalmond;">КОМПОНЕНТ</th><th style="background-color: blanchedalmond;">КОМПОНЕНТ</th><th style="background-color: blanchedalmond;">КОМПОНЕНТ</th><th style="background-color: blanchedalmond;">АРТИКУЛ</th><th style="background-color: blanchedalmond;">буй</th><th style="background-color: blanchedalmond;">Экструзия (пресс)
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Пила холодной резки 
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">буй</th><th style="background-color: blanchedalmond;">Старение
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">SKM - SKM покраска
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">SAT - SAT покраска
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">ГР - ГР покраска
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">SKM Хим. Обработка
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">SAT Хим. Обработка
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">ГР Хим. Обработка
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Ручная покраска
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">Сублимация
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">Комбинирование 
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Комбинированный + Упаковка
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">Наклейка
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Упаковка
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Про-во в сутки
                       (буй)</th><th style="background-color: blanchedalmond;">Ламинация + Наклейка + Упаковка
                       Ламинация + Упаковка
                        1 буй(сек)</th><th style="background-color: blanchedalmond;">Действие</th></tr>

                  {%for texcarta in products %}
                    <tr >
                     
                      <td style="background-color: aliceblue;">{{texcarta.компонент_1 }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.компонент_2 }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.компонент_3 }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.артикул }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.пресс_1_линия_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.ekstruziya }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.pila }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.закалка_1_печь_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.strayenie }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.покраска_SKM_белый_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.skm_pokras}}</td>
                      <td style="background-color: aliceblue;">{{texcarta.покраска_SAT_базовый_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.sat_pokras }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.покраска_горизонтал_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.gr_pokras }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.покраска_ручная_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.skm_xim }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.sat_xim }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.gr_xim }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.ruchnoy_pokraska }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.вакуум_1_печка_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.sublimat }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.термо_1_линия_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.kombinirovan }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.kom_upakovka }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.наклейка_упаковка_1_линия_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.nakleyka }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.upakovka }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.ламинат_1_линия_про_во_в_сутки_буй }}</td>
                      <td style="background-color: aliceblue;">{{texcarta.lam_nak_upakovka }}</td>
                      <td style="background-color: aliceblue;"><a class="btn btn-warning btn-fw mx-1" href="{% url 'edit_sikl' texcarta.id %}"><i class="mdi mdi-eyedropper"></i>Edit</a></td>
                  
                      <!-- <td style="background-color: aliceblue;"><a type="button" class="btn btn-danger btn-fw"  onclick="delete_norm(this,{{norm.id}})"><i class="mdi mdi-delete"></i>Delete</a</td> -->
                    </tr>
                  {%endfor%}
                </table>
              
              </div>
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-center "><button type="button" class="btn btn-success btn-fw" style="display: none;" id="buttonupload">Добавить нормы</button></div>
        
      </div>
      

      
    </div>
   
  </div>
  <div class="container">
    <div class="d-flex justify-content-between">
        <div class="pagination p-2">
          <span class="step-links">
            <ul class="pagination"  style="background-color: azure;">
                {% if products.has_previous %}
                <li class="page-item" ><a class="page-link"  style="background-color: azure;" href="?page={{ products.previous_page_number }}{%if search%}&search={{search}}{%endif%}">Previous</a></li>
                    {% if products.number > 3 %}
                        <li class="page-item"><a class="page-link"  style="background-color: azure;" href="?page=1{%if search%}&search={{search}}{%endif%}">1</a></li>
                        {% if products.number > 4 %}
                        <li class="page-item"  style="background-color: azure;"> <span style="color: black;">...</span></li>
                        {% endif %}
                    {% endif %}
                {% endif %}

                {% for num in products.paginator.page_range %}
                    {% if products.number == num %}
                        <li class="page-item"><a class="page-link"  style="background-color: azure;" href="?page={{ num }}{%if search%}&search={{search}}{%endif%}">{{ num }}</a></li>
                    {% elif num > products.number|add:'-3' and num < products.number|add:'3' %}
                        <li class="page-item"><a class="page-link"  style="background-color: azure;" href="?page={{ num }}{%if search%}&search={{search}}{%endif%}">{{ num }}</a></li>
                    {% endif %}
                {% endfor %}

                {% if products.has_next %}
                    {% if products.number < products.paginator.num_pages|add:'-3' %}
                    <li class="page-item"  style="background-color: azure;" > <span style="color: black;">...</span></li>
                    <li class="page-item"><a class="page-link"  style="background-color: azure;"  href="?page={{ products.paginator.num_pages }}{%if search%}&search={{search}}{%endif%}">{{ products.paginator.num_pages }}</a></li>
                    {% elif products.number < products.paginator.num_pages|add:'-2' %}
                    <li class="page-item"><a class="page-link"  style="background-color: azure;" href="?page={{ products.paginator.num_pages }}{%if search%}&search={{search}}{%endif%}">{{ products.paginator.num_pages }}</a></li>
                    {% endif %}
                    
                    <li class="page-item"><a class="page-link"  style="background-color: azure;" href="?page={{ products.next_page_number }}{%if search%}&search={{search}}{%endif%}">Next Page »</a></li>
                   
                {% endif %}
              </ul>
          </span>
        </div>
    </div>
  </div>
<script>
  function delete_norm(elem,id){
    console.log(id)
    url =`/norma/delete-norm/${id}`
    console.log(url)


    Swal.fire({
      showDenyButton: true,
      confirmButtonText: 'Normani o\'chirmoqchimisiz?',
      denyButtonText: `Yo'q`,
    }).then((result) => {
      if (result.isConfirmed) {
       
        $.ajax({
                    method: "POST",
                    url: url
                    
                  }).done(function( msg ) {
                    
                    if (msg.msg ==true){
                       remove_me(elem);
                        Swal.fire({
                            position: 'top-end',
                            icon: 'success',
                            title: msg.text,
                            showConfirmButton: false,
                            timer: 1000
                          })
                      
                        }else{
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: msg.text
                              })
    
                        }
                    });
      } else if (result.isDenied) {
        Swal.fire('!!!', 'Ok', 'info')
      }
    })
  }

  function remove_me(elem){
    elem.parentElement.parentElement.remove()
  }
</script>
{% endblock %}